<template>
  <view class="calculator-page">
    <!-- Â§¥ÈÉ®ÂØºËà™ -->
    <view class="nav-header">
      <view class="nav-back" @click="goBack">
        <text class="back-icon">‚Üê</text>
      </view>
      <text class="nav-title">{{ t('calculator.title') }}</text>
      <view class="nav-placeholder"></view>
    </view>

    <!-- ‰∏ªË¶ÅÂÜÖÂÆπ -->
    <scroll-view class="content-scroll" scroll-y>
      <!-- ËÆ°ÁÆóË°®Âçï -->
      <view class="calculator-form">
        
        <!-- ËøêËæìÊñπÂºèÈÄâÊã© -->
        <view class="form-section">
          <view class="section-header">
            <text class="required-star">*</text>
            <text class="section-title">{{ t('calculator.transport') }}</text>
          </view>
          <view class="radio-group">
            <view 
              class="radio-item" 
              :class="{ active: formData.transport === 'sea', disabled: formData.logistics === 'postal_ems' }"
              @click="selectTransport('sea')"
            >
              <view class="radio-check">
                <text v-if="formData.transport === 'sea'" class="check-icon">‚úì</text>
              </view>
              <text class="radio-label">{{ t('calculator.seaTransport') }}</text>
            </view>
            <view 
              class="radio-item" 
              :class="{ active: formData.transport === 'air' }"
              @click="selectTransport('air')"
            >
              <view class="radio-check">
                <text v-if="formData.transport === 'air'" class="check-icon">‚úì</text>
              </view>
              <text class="radio-label">{{ t('calculator.airTransport') }}</text>
            </view>
          </view>
          <text v-if="errors.transport" class="error-text">{{ errors.transport }}</text>
        </view>

        <!-- Áâ©ÊµÅÊñπÂºèÈÄâÊã© -->
        <view class="form-section">
          <view class="section-header">
            <text class="required-star">*</text>
            <text class="section-title">{{ t('calculator.logistics') }}</text>
          </view>
          <view class="radio-group">
            <view 
              class="radio-item" 
              :class="{ active: formData.logistics === 'korea_express' }"
              @click="selectLogistics('korea_express')"
            >
              <view class="radio-check">
                <text v-if="formData.logistics === 'korea_express'" class="check-icon">‚úì</text>
              </view>
              <text class="radio-label">{{ t('calculator.koreaExpress') }}</text>
            </view>
            <view 
              class="radio-item" 
              :class="{ active: formData.logistics === 'postal_ems' }"
              @click="selectLogistics('postal_ems')"
            >
              <view class="radio-check">
                <text v-if="formData.logistics === 'postal_ems'" class="check-icon">‚úì</text>
              </view>
              <text class="radio-label">{{ t('calculator.postalEms') }}</text>
            </view>
          </view>
          <text v-if="errors.logistics" class="error-text">{{ errors.logistics }}</text>
        </view>

        <!-- ÈáçÈáèËæìÂÖ• -->
        <view class="form-section">
          <view class="section-header">
            <text class="required-star">*</text>
            <text class="section-title">{{ t('calculator.weight') }}</text>
          </view>
          <view class="input-group">
            <input 
              class="form-input"
              :class="{ error: errors.weight }"
              type="digit"
              :placeholder="t('calculator.weightPlaceholder')"
              v-model="formData.weight"
              @blur="validateWeight"
              @input="clearError('weight')"
            />
            <text class="input-unit">kg</text>
          </view>
          <text v-if="errors.weight" class="error-text">{{ errors.weight }}</text>
        </view>

        <!-- Â∞∫ÂØ∏ËæìÂÖ• -->
        <view class="dimensions-section">
          <!-- ÈïøÂ∫¶ -->
          <view class="form-section">
            <view class="section-header">
              <text class="required-star">*</text>
              <text class="section-title">{{ t('calculator.length') }}</text>
            </view>
            <view class="input-group">
              <input 
                class="form-input"
                :class="{ error: errors.length }"
                type="digit"
                :placeholder="t('calculator.lengthPlaceholder')"
                v-model="formData.length"
                @blur="validateLength"
                @input="clearError('length')"
              />
              <text class="input-unit">cm</text>
            </view>
            <text v-if="errors.length" class="error-text">{{ errors.length }}</text>
          </view>

          <!-- ÂÆΩÂ∫¶ -->
          <view class="form-section">
            <view class="section-header">
              <text class="required-star">*</text>
              <text class="section-title">{{ t('calculator.width') }}</text>
            </view>
            <view class="input-group">
              <input 
                class="form-input"
                :class="{ error: errors.width }"
                type="digit"
                :placeholder="t('calculator.widthPlaceholder')"
                v-model="formData.width"
                @blur="validateWidth"
                @input="clearError('width')"
              />
              <text class="input-unit">cm</text>
            </view>
            <text v-if="errors.width" class="error-text">{{ errors.width }}</text>
          </view>

          <!-- È´òÂ∫¶ -->
          <view class="form-section">
            <view class="section-header">
              <text class="required-star">*</text>
              <text class="section-title">{{ t('calculator.height') }}</text>
            </view>
            <view class="input-group">
              <input 
                class="form-input"
                :class="{ error: errors.height }"
                type="digit"
                :placeholder="t('calculator.heightPlaceholder')"
                v-model="formData.height"
                @blur="validateHeight"
                @input="clearError('height')"
              />
              <text class="input-unit">cm</text>
            </view>
            <text v-if="errors.height" class="error-text">{{ errors.height }}</text>
          </view>
        </view>

        <!-- ‰ª∂Êï∞ËæìÂÖ• -->
        <view class="form-section">
          <view class="section-header">
            <text class="required-star">*</text>
            <text class="section-title">{{ t('calculator.quantity') }}</text>
          </view>
          <view class="input-group">
            <input 
              class="form-input"
              :class="{ error: errors.quantity }"
              type="number"
              :placeholder="t('calculator.quantityPlaceholder')"
              v-model="formData.quantity"
              @blur="validateQuantity"
              @input="clearError('quantity')"
            />
          </view>
          <text v-if="errors.quantity" class="error-text">{{ errors.quantity }}</text>
        </view>

        <!-- Êèê‰∫§ÊåâÈíÆ -->
        <view class="submit-section">
          <button 
            class="submit-btn"
            :class="{ loading: isCalculating }"
            @click="calculateShipping"
            :disabled="isCalculating"
          >
            <text v-if="isCalculating" class="loading-text">{{ t('calculator.calculating') }}</text>
            <text v-else class="btn-text">{{ t('calculator.calculate') }}</text>
          </button>
        </view>

        <!-- ËÆ°ÁÆóÁªìÊûú -->
        <view v-if="result" class="result-section">
          <view class="result-card">
            <view class="result-header">
              <text class="result-title">üí∞ {{ t('calculator.resultTitle') }}</text>
            </view>
            <view class="result-content">
              <view class="result-item">
                <text class="result-label">{{ t('calculator.transportMethod') }}Ôºö</text>
                <text class="result-value">{{ getTransportLabel(formData.transport) }}</text>
              </view>
              <view class="result-item">
                <text class="result-label">{{ t('calculator.logisticsMethod') }}Ôºö</text>
                <text class="result-value">{{ getLogisticsLabel(formData.logistics) }}</text>
              </view>
              <view class="result-item">
                <text class="result-label">{{ t('calculator.actualWeight') }}Ôºö</text>
                <text class="result-value">{{ formData.weight }}kg</text>
              </view>
              <view class="result-item">
                <text class="result-label">{{ t('calculator.volumeWeight') }}Ôºö</text>
                <text class="result-value">{{ result.volumeWeight }}kg</text>
              </view>
              <view class="result-item">
                <text class="result-label">{{ t('calculator.chargingWeight') }}Ôºö</text>
                <text class="result-value">{{ result.chargingWeight }}kg</text>
              </view>
              <view class="result-item">
                <text class="result-label">{{ t('calculator.packageCount') }}Ôºö</text>
                <text class="result-value">{{ formData.quantity }}{{ t('calculator.packageUnit') }}</text>
              </view>
              <view class="result-divider"></view>
              <view class="result-total">
                <text class="total-label">{{ t('calculator.totalShippingFee') }}Ôºö</text>
                <text class="total-amount">¬•{{ result.totalAmount }}</text>
              </view>
            </view>
          </view>
        </view>

        <!-- ËøêË¥πÊ†áÂáÜËØ¥Êòé -->
        <view class="pricing-info">
          <view class="info-header">
            <text class="info-title">üìã {{ t('calculator.pricingStandard') }}</text>
          </view>
          <view class="pricing-list">
            <view class="pricing-item">
              <view class="pricing-icon">üö¢</view>
              <view class="pricing-content">
                <text class="pricing-type">{{ t('calculator.seaShipping') }}</text>
                <text class="pricing-detail">{{ t('calculator.seaShippingPrice') }}</text>
              </view>
            </view>
            <view class="pricing-item">
              <view class="pricing-icon">‚úàÔ∏è</view>
              <view class="pricing-content">
                <text class="pricing-type">{{ t('calculator.airShipping') }}</text>
                <text class="pricing-detail">{{ t('calculator.airShippingPrice') }}</text>
              </view>
            </view>
            <view class="pricing-item">
              <view class="pricing-icon">üìÆ</view>
              <view class="pricing-content">
                <text class="pricing-type">{{ t('calculator.postalShipping') }}</text>
                <text class="pricing-detail">{{ t('calculator.postalShippingPrice') }}</text>
              </view>
            </view>
          </view>
        </view>
      </view>

      <!-- Â∫ïÈÉ®ÂÆâÂÖ®Ë∑ùÁ¶ª -->
      <view class="bottom-safe"></view>
    </scroll-view>
  </view>
</template>

<script setup lang="ts">
import { ref, reactive, onMounted } from 'vue'
import { locale, t, initLocale, setLanguagePacks } from '../../utils/i18n'
import { zhLanguagePack, koLanguagePack } from '../../locales/index'

// ÂàùÂßãÂåñÂ§öËØ≠Ë®ÄÁ≥ªÁªü
onMounted(() => {
  setLanguagePacks({
    zh: zhLanguagePack,
    ko: koLanguagePack
  })
  initLocale()
})

// Á±ªÂûãÂÆö‰πâ
interface FormData {
  transport: string
  logistics: string
  weight: string
  length: string
  width: string
  height: string
  quantity: string
}

interface Errors {
  transport: string
  logistics: string
  weight: string
  length: string
  width: string
  height: string
  quantity: string
}

interface CalculationResult {
  totalAmount: string
  formula: string
  volumeWeight: string
  chargingWeight: string
  breakdown: {
    basePrice: number
    additionalPrice: number
    quantity: number
  }
}

// Ë°®ÂçïÊï∞ÊçÆ
const formData = reactive<FormData>({
  transport: '', // ËøêËæìÊñπÂºè: sea/air
  logistics: '', // Áâ©ÊµÅÊñπÂºè: korea_express/postal_ems
  weight: '',
  length: '',
  width: '',
  height: '',
  quantity: '1'
})

// ÈîôËØØ‰ø°ÊÅØ
const errors = reactive<Errors>({
  transport: '',
  logistics: '',
  weight: '',
  length: '',
  width: '',
  height: '',
  quantity: ''
})

// ËÆ°ÁÆóÁä∂ÊÄÅÂíåÁªìÊûú
const isCalculating = ref(false)
const result = ref<CalculationResult | null>(null)

// ËøîÂõû‰∏ä‰∏ÄÈ°µ
const goBack = () => {
  uni.navigateBack()
}

// ÈÄâÊã©ËøêËæìÊñπÂºè
const selectTransport = (type: string) => {
  // Â¶ÇÊûúÈÄâÊã©‰∫ÜÈÇÆÊîøEMSÔºå‰∏çËÉΩÈÄâÊã©Êµ∑Ëøê
  if (formData.logistics === 'postal_ems' && type === 'sea') {
    uni.showToast({
      title: t('calculator.postalSeaNotSupported'),
      icon: 'none'
    })
    return
  }
  formData.transport = type
  clearError('transport')
}

// ÈÄâÊã©Áâ©ÊµÅÊñπÂºè
const selectLogistics = (type: string) => {
  formData.logistics = type
  clearError('logistics')
  
  // Â¶ÇÊûúÈÄâÊã©‰∫ÜÈÇÆÊîøEMSÔºå‰∏îÂΩìÂâçÈÄâÊã©‰∫ÜÊµ∑ËøêÔºåÂàôÂàáÊç¢Âà∞Á©∫Ëøê
  if (type === 'postal_ems' && formData.transport === 'sea') {
    formData.transport = 'air'
    uni.showToast({
      title: t('calculator.postalAirOnlySupported'),
      icon: 'none'
    })
  }
}

// Ê∏ÖÈô§ÈîôËØØ‰ø°ÊÅØ
const clearError = (field: keyof Errors) => {
  errors[field] = ''
}

// È™åËØÅÂáΩÊï∞
const validateTransport = () => {
  if (!formData.transport) {
    errors.transport = 'ËØ∑ÈÄâÊã©ËøêËæìÊñπÂºè'
    return false
  }
  return true
}

const validateLogistics = () => {
  if (!formData.logistics) {
    errors.logistics = 'ËØ∑ÈÄâÊã©Áâ©ÊµÅÊñπÂºè'
    return false
  }
  return true
}

const validateWeight = () => {
  if (!formData.weight) {
    errors.weight = 'ËØ∑ËæìÂÖ•ÈáçÈáè'
    return false
  }
  const weight = parseFloat(formData.weight)
  if (isNaN(weight) || weight <= 0) {
    errors.weight = 'ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑÈáçÈáè'
    return false
  }
  if (weight > 100) {
    errors.weight = 'ÈáçÈáè‰∏çËÉΩË∂ÖËøá100kg'
    return false
  }
  return true
}

const validateLength = () => {
  if (!formData.length) {
    errors.length = 'ËØ∑ËæìÂÖ•ÈïøÂ∫¶'
    return false
  }
  const length = parseFloat(formData.length)
  if (isNaN(length) || length <= 0) {
    errors.length = 'ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑÈïøÂ∫¶'
    return false
  }
  return true
}

const validateWidth = () => {
  if (!formData.width) {
    errors.width = 'ËØ∑ËæìÂÖ•ÂÆΩÂ∫¶'
    return false
  }
  const width = parseFloat(formData.width)
  if (isNaN(width) || width <= 0) {
    errors.width = 'ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑÂÆΩÂ∫¶'
    return false
  }
  return true
}

const validateHeight = () => {
  if (!formData.height) {
    errors.height = 'ËØ∑ËæìÂÖ•È´òÂ∫¶'
    return false
  }
  const height = parseFloat(formData.height)
  if (isNaN(height) || height <= 0) {
    errors.height = 'ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑÈ´òÂ∫¶'
    return false
  }
  return true
}

const validateQuantity = () => {
  if (!formData.quantity) {
    errors.quantity = 'ËØ∑ËæìÂÖ•‰ª∂Êï∞'
    return false
  }
  const quantity = parseInt(formData.quantity)
  if (isNaN(quantity) || quantity <= 0) {
    errors.quantity = 'ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑ‰ª∂Êï∞'
    return false
  }
  if (quantity > 50) {
    errors.quantity = '‰ª∂Êï∞‰∏çËÉΩË∂ÖËøá50‰ª∂'
    return false
  }
  return true
}

// È™åËØÅÊâÄÊúâÂ≠óÊÆµ
const validateAll = () => {
  const validations = [
    validateTransport(),
    validateLogistics(),
    validateWeight(),
    validateLength(),
    validateWidth(),
    validateHeight(),
    validateQuantity()
  ]
  return validations.every(v => v)
}

// Ëé∑ÂèñËøêËæìÊñπÂºèÊ†áÁ≠æ
const getTransportLabel = (transport: string) => {
  return transport === 'sea' ? t('calculator.seaTransport') : t('calculator.airTransport')
}

// Ëé∑ÂèñÁâ©ÊµÅÊñπÂºèÊ†áÁ≠æ  
const getLogisticsLabel = (logistics: string) => {
  return logistics === 'korea_express' ? t('calculator.koreaExpress') : t('calculator.postalEms')
}

// ËÆ°ÁÆó‰ΩìÁßØÈáçÈáè
const calculateVolumeWeight = (length: number, width: number, height: number): number => {
  return (length * width * height) / 6000
}

// ËÆ°ÁÆóËøêË¥πÊé•Âè£ÔºàÈ¢ÑÁïôÔºâ
const calculateShippingAPI = async (data: FormData): Promise<CalculationResult> => {
  // ËøôÈáåÊòØÈ¢ÑÁïôÁöÑËÆ°ÁÆóÊé•Âè£ÔºåÂÆûÈôÖÈ°πÁõÆ‰∏≠ÈúÄË¶ÅË∞ÉÁî®ÂêéÁ´ØAPI
  return new Promise((resolve) => {
    setTimeout(() => {
      const actualWeight = parseFloat(data.weight)
      const length = parseFloat(data.length)
      const width = parseFloat(data.width)
      const height = parseFloat(data.height)
      const quantity = parseInt(data.quantity)
      
      // ËÆ°ÁÆó‰ΩìÁßØÈáçÈáè
      const volumeWeight = calculateVolumeWeight(length, width, height)
      
      // ÂèñÂÆûÈôÖÈáçÈáèÂíå‰ΩìÁßØÈáçÈáèÁöÑËæÉÂ§ßÂÄº‰Ωú‰∏∫ËÆ°Ë¥πÈáçÈáè
      const chargingWeight = Math.max(actualWeight, volumeWeight)
      
      let basePrice = 0
      let additionalPrice = 0
      let formula = ''
      
      if (data.logistics === 'postal_ems') {
        // ÈÇÆÊîøEMSÔºöÈ¶ñÈáç70ÂÖÉ+Áª≠Èáç1ÂÖÉ/50g
        basePrice = 70
        if (chargingWeight > 0.05) { // 50g = 0.05kg
          const additionalWeight = Math.ceil((chargingWeight - 0.05) / 0.05) // Êåâ50gËøõ‰Ωç
          additionalPrice = additionalWeight * 1
        }
        formula = chargingWeight > 0.05 
          ? `70 + ${Math.ceil((chargingWeight - 0.05) / 0.05)} √ó 1 √ó ${quantity} = ${(basePrice + additionalPrice) * quantity}`
          : `70 √ó ${quantity} = ${basePrice * quantity}`
      } else {
        // CJÂ§ßÈü©ÈÄöËøê
        if (data.transport === 'sea') {
          // Êµ∑ËøêÔºöÈ¶ñÈáç25ÂÖÉ+Áª≠Èáç6ÂÖÉ/kg
          basePrice = 25
          if (chargingWeight > 1) {
            additionalPrice = (chargingWeight - 1) * 6
          }
          formula = chargingWeight > 1 
            ? `25 + (${chargingWeight.toFixed(2)} - 1) √ó 6 √ó ${quantity} = ${(basePrice + additionalPrice) * quantity}`
            : `25 √ó ${quantity} = ${basePrice * quantity}`
        } else if (data.transport === 'air') {
          // Á©∫ËøêÔºöÈ¶ñÈáç33.8ÂÖÉ+Áª≠Èáç9ÂÖÉ/0.5kg
          basePrice = 33.8
          if (chargingWeight > 0.5) {
            const additionalWeight = Math.ceil((chargingWeight - 0.5) / 0.5)
            additionalPrice = additionalWeight * 9
          }
          formula = chargingWeight > 0.5 
            ? `33.8 + ${Math.ceil((chargingWeight - 0.5) / 0.5)} √ó 9 √ó ${quantity} = ${(basePrice + additionalPrice) * quantity}`
            : `33.8 √ó ${quantity} = ${basePrice * quantity}`
        }
      }
      
      const totalAmount = ((basePrice + additionalPrice) * quantity).toFixed(2)
      
      resolve({
        totalAmount,
        formula,
        volumeWeight: volumeWeight.toFixed(2),
        chargingWeight: chargingWeight.toFixed(2),
        breakdown: {
          basePrice,
          additionalPrice,
          quantity
        }
      })
    }, 1500)
  })
}

// ËÆ°ÁÆóËøêË¥π
const calculateShipping = async () => {
  if (!validateAll()) {
    uni.showToast({
      title: 'ËØ∑ÂÆåÂñÑÂøÖÂ°´‰ø°ÊÅØ',
      icon: 'none'
    })
    return
  }
  
  isCalculating.value = true
  
  try {
    const calculationResult = await calculateShippingAPI(formData)
    result.value = calculationResult
    
    // ÊªöÂä®Âà∞ÁªìÊûúÂå∫Âüü
    uni.pageScrollTo({
      duration: 300,
      scrollTop: 1000
    })
    
  } catch (error) {
    uni.showToast({
      title: 'ËÆ°ÁÆóÂ§±Ë¥•ÔºåËØ∑ÈáçËØï',
      icon: 'none'
    })
  } finally {
    isCalculating.value = false
  }
}
</script>

<style scoped>
/* È°µÈù¢ÂÆπÂô® */
.calculator-page {
  min-height: 100vh;
  width: 100vw;
  max-width: 100vw;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  overflow-x: hidden;
  box-sizing: border-box;
}

/* Â§¥ÈÉ®ÂØºËà™ */
.nav-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 60rpx 30rpx 30rpx;
  position: sticky;
  top: 0;
  z-index: 100;
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(20rpx);
  width: 100%;
  max-width: 100%;
  box-sizing: border-box;
}

.nav-back {
  width: 60rpx;
  height: 60rpx;
  border-radius: 20rpx;
  background: rgba(255, 255, 255, 0.2);
  display: flex;
  align-items: center;
  justify-content: center;
}

.back-icon {
  font-size: 32rpx;
  color: white;
  font-weight: bold;
}

.nav-title {
  font-size: 36rpx;
  font-weight: 600;
  color: white;
}

.nav-placeholder {
  width: 60rpx;
}

/* ÂÜÖÂÆπÊªöÂä®Âå∫ */
.content-scroll {
  height: calc(100vh - 150rpx);
  padding: 0 30rpx;
  width: 100%;
  max-width: 100%;
  box-sizing: border-box;
}

/* Ë°®ÂçïÂÆπÂô® */
.calculator-form {
  background: white;
  border-radius: 32rpx;
  padding: 40rpx;
  margin-bottom: 40rpx;
  box-shadow: 0 8rpx 32rpx rgba(0, 0, 0, 0.1);
}

/* Ë°®ÂçïÂå∫Âùó */
.form-section {
  margin-bottom: 40rpx;
}

.section-header {
  display: flex;
  align-items: center;
  margin-bottom: 20rpx;
}

.required-star {
  color: #ff4757;
  font-size: 28rpx;
  font-weight: bold;
  margin-right: 8rpx;
}

.section-title {
  font-size: 28rpx;
  font-weight: 600;
  color: #2c3e50;
}

/* ÂçïÈÄâÊåâÈíÆÁªÑ */
.radio-group {
  display: flex;
  gap: 30rpx;
}

.radio-item {
  display: flex;
  align-items: center;
  padding: 20rpx;
  border-radius: 16rpx;
  border: 2rpx solid #e9ecef;
  background: #f8f9fa;
  cursor: pointer;
  transition: all 0.3s ease;
  flex: 1;
}

.radio-item.active {
  border-color: #667eea;
  background: rgba(102, 126, 234, 0.1);
}

.radio-check {
  width: 40rpx;
  height: 40rpx;
  border-radius: 50%;
  border: 2rpx solid #dee2e6;
  margin-right: 16rpx;
  display: flex;
  align-items: center;
  justify-content: center;
  background: white;
  transition: all 0.3s ease;
}

.radio-item.active .radio-check {
  border-color: #667eea;
  background: #667eea;
}

.check-icon {
  color: white;
  font-size: 20rpx;
  font-weight: bold;
}

.radio-label {
  font-size: 26rpx;
  color: #495057;
  font-weight: 500;
}

.radio-item.active .radio-label {
  color: #667eea;
  font-weight: 600;
}

.radio-item.disabled {
  opacity: 0.5;
  cursor: not-allowed;
  background: #f1f3f4;
}

.radio-item.disabled .radio-check {
  border-color: #ced4da;
  background: #f1f3f4;
}

.radio-item.disabled .radio-label {
  color: #adb5bd;
}

/* ËæìÂÖ•Ê°ÜÁªÑ */
.input-group {
  position: relative;
  display: flex;
  align-items: center;
}

.form-input {
  flex: 1;
  height: 80rpx;
  padding: 0 20rpx;
  border: 2rpx solid #e9ecef;
  border-radius: 16rpx;
  font-size: 28rpx;
  color: #495057;
  background: #f8f9fa;
}

.form-input.error {
  border-color: #ff4757;
}

.form-input:focus {
  border-color: #667eea;
  background: white;
}

.input-unit {
  position: absolute;
  right: 20rpx;
  font-size: 24rpx;
  color: #6c757d;
  background: white;
  padding: 0 8rpx;
}

/* Â∞∫ÂØ∏Âå∫Âüü */
.dimensions-section {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 20rpx;
}

/* ÈîôËØØÊèêÁ§∫ */
.error-text {
  color: #ff4757;
  font-size: 22rpx;
  margin-top: 8rpx;
  display: block;
}

/* Êèê‰∫§Âå∫Âüü */
.submit-section {
  margin-top: 60rpx;
}

.submit-btn {
  width: 100%;
  height: 100rpx;
  border-radius: 24rpx;
  background: linear-gradient(135deg, #667eea, #764ba2);
  color: white;
  font-size: 32rpx;
  font-weight: 600;
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
}

.submit-btn:active {
  transform: scale(0.96);
}

.submit-btn.loading {
  background: #95a5a6;
}

.submit-btn[disabled] {
  opacity: 0.6;
}

.loading-text, .btn-text {
  color: white;
}

/* ÁªìÊûúÂå∫Âüü */
.result-section {
  margin-top: 40rpx;
}

.result-card {
  background: rgba(102, 126, 234, 0.05);
  border-radius: 24rpx;
  padding: 32rpx;
  border: 2rpx solid rgba(102, 126, 234, 0.2);
}

.result-header {
  margin-bottom: 24rpx;
}

.result-title {
  font-size: 28rpx;
  font-weight: 600;
  color: #2c3e50;
}

.result-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16rpx;
}

.result-label {
  font-size: 24rpx;
  color: #6c757d;
}

.result-value {
  font-size: 24rpx;
  color: #495057;
  font-weight: 500;
}

.result-divider {
  height: 1rpx;
  background: #dee2e6;
  margin: 24rpx 0;
}

.result-total {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16rpx;
}

.total-label {
  font-size: 28rpx;
  font-weight: 600;
  color: #2c3e50;
}

.total-amount {
  font-size: 32rpx;
  font-weight: 700;
  color: #ff4757;
}

.result-formula {
  text-align: center;
  margin-top: 16rpx;
}

.formula-text {
  font-size: 22rpx;
  color: #6c757d;
  background: rgba(255, 255, 255, 0.8);
  padding: 12rpx 20rpx;
  border-radius: 12rpx;
}

/* ËøêË¥πÊ†áÂáÜËØ¥Êòé */
.pricing-info {
  background: white;
  border-radius: 24rpx;
  padding: 32rpx;
  margin-top: 24rpx;
  box-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.08);
}

.info-header {
  margin-bottom: 24rpx;
}

.info-title {
  font-size: 26rpx;
  font-weight: 600;
  color: #2c3e50;
}

.pricing-item {
  display: flex;
  align-items: center;
  padding: 20rpx;
  background: rgba(102, 126, 234, 0.05);
  border-radius: 16rpx;
  margin-bottom: 16rpx;
}

.pricing-icon {
  font-size: 32rpx;
  margin-right: 20rpx;
}

.pricing-content {
  flex: 1;
}

.pricing-type {
  font-size: 24rpx;
  font-weight: 600;
  color: #2c3e50;
  margin-right: 20rpx;
}

.pricing-detail {
  font-size: 22rpx;
  color: #6c757d;
}

.bottom-safe {
  height: 60rpx;
}

/* ÂìçÂ∫îÂºè */
@media (max-width: 400px) {
  .dimensions-section {
    grid-template-columns: 1fr;
  }
  
  .radio-group {
    flex-direction: column;
    gap: 16rpx;
  }
}
</style>
